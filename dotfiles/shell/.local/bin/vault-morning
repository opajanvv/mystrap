#!/bin/bash
# vault-morning: Generate morning routine without LLM
# Replaces: claude -p "/morning"

export PATH="$HOME/.local/bin:$PATH"
set -e

VAULT_DIR="$HOME/Cloud/janvv/life/planning"
TODAY_FILE="$VAULT_DIR/TODAY.md"
DATE=$(date +%Y-%m-%d)

cd "$VAULT_DIR"

# Step 1: Process Braintoss inbox
echo "Processing Braintoss inbox..."
braintoss-inbox || echo "braintoss-inbox failed or not available"

# Step 2: Clean up completed items
echo "Cleaning up completed items..."
cleanup_result=$(vault-cleanup 2>/dev/null || echo '{"counts":{"total":0}}')
cleanup_count=$(echo "$cleanup_result" | jq -r '.counts.total // 0')
echo "Cleaned up $cleanup_count items"

# Step 3: Generate TODAY.md
vault-today

echo "Morning routine complete."
